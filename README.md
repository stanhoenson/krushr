This project is [FOSS](https://en.wikipedia.org/wiki/Free_and_open-source_software), available under the [BSD-3 Clause license](https://opensource.org/licenses/BSD-3-Clause).

# Krushr

Host and manage routes in your area.

## Description

Krushr is a full-stuck application for managing routes.
It consists of a JSON web API built in [Go](https://go.dev/) and a web interface
built with [Astro](https://astro.build/) and [Svelte](https://svelte.dev/).

There is no central instance, so we encourage you to run your own instance for your area.

However, we do run a ["demo" instance](https://krushr.hoenson.xyz).

## Requirements

- Go 1.20, or above
- Node 18.16.0, or above
- GNU Make 3.81, or above

## Installation

### Server

There are a few things you need to have installed on your server before being able to run an instance.
We recommend following [this guide](https://landchad.net/).

Apart from that, you'll also need to have [Docker](https://www.docker.com/) installed.

Further instructions on how to host your instance are below.

### Prerequisites

- [Install Go](https://go.dev/doc/install)
  - Or install it via your package manager
- [Install Node](https://nodejs.org/en)
  - But preferably install it via [`fnm`](https://github.com/Schniz/fnm) or [`nvm`](https://github.com/nvm-sh/nvm)

### Application

- Clone the repository to your preferred location
- Run `install.sh` (but always read scripts before running them)
  - This will install all dependencies for the backend and frontend

## Examples

If any of these instructions don't work, feel free to send a pull request with the fix or send an email to stan@hoenson.xyz.

### Run the application locally

- Run the backend:

```
cd ./backend/krushr
make run/api
```

- Run the frontend:

```
cd ./frontend/krushr
npm run start
```

- Go to `localhost:3000` with your preferred web browser.

### Initialize an instance

- Fork the repository
- Read [this guide](https://stefanbauer.me/articles/how-to-keep-your-git-fork-up-to-date)
- Change `./backend/krushr/.env`
  - `API_URL`: set this to the full URL where you plan to host your instance
  - `DOMAIN`: set this to *just* the domain name, so for `https://github.com` that would be; **github**
  - `JWT_SECRET`: set this to something preferably generated by a password manager
  - The other variables can stay like they are, but you can of course change them
- Change `./frontend/krushr/.env`
  - `PUBLIC_API_BASE_URL`: set this to what you've set for `<API_URL>/api`

### Keep your instance up-to-date

-

## Configuration

-

## Contributing

-

## Testing

### Backend

Go provides us with great built-in testing capabilities and tooling.
We've used a Makefile to simplify it even further.

- `make audit`

(Note: for this command to work, you need to have [`gofumpt`](https://github.com/mvdan/gofumpt) and [`staticcheck`](https://github.com/dominikh/go-tools) installed.
Also, you need to be in `./backend/krushr` to run this command.)

This command does multiple things. It tidies and verifies dependencies, it formats the code, it "vets" the code and finally, it runs the tests.

The vetting and linter will tell you about problems with your code and where they're located, so you can fix them.
Only when all the problems are solved, will the tests be run.

When the tests fail, you should see the expected value and the actual value.
Also, you'll see the test coverage.

- `make coverage`

This command will test your code, create a coverage profile and open said profile in your browser.

This shows you very precisely which parts of your code are covered and which aren't.

### Frontend

-

## Licensing

This project is FOSS, available under the [BSD-3 Clause license](https://opensource.org/licenses/BSD-3-Clause).

## Further reading

Below are some resources we would recommend for getting started with Go, Astro and Svelte.

We would also highly recommend you check out the documentation for each tool.

### Go

- [Go by Example](https://gobyexample.com/): a website with examples on how to many different things in Go
- [Boldly Go](https://boldlygo.tech/): a blog about Go programming
- [For the Love of Go](https://bitfieldconsulting.com/books/love): a book for beginner programmers
- [Learning Go](https://www.oreilly.com/library/view/learning-go/9781492077206/): a book for competent programmers, but new to Go
- [Go is a great programming language](https://drewdevault.com/2021/04/02/Go-is-a-great-language.html): a short article praising Go

### Astro and Svelte

- [Astro in 100 seconds](https://www.youtube.com/watch?v=dsTXcSeAZq80): a short introductory video for Astro
- [Svelte in 100 seconds](https://www.youtube.com/watch?v=rv3Yq-B8qp4): a short introductory video for Svelte

### Miscellaneous

- [LandChad.net](https://landchad.net/): a website for setting up your server
- [The transitional web](https://gomakethings.com/the-transitional-web/): a short article about the state of the web
- [Consider SQLite](https://blog.wesleyac.com/posts/consider-sqlite): an article pointing out some misconceptions about SQLite
- [The small web is beautiful](https://benhoyt.com/writings/the-small-web-is-beautiful/): an essay advocating for using "smaller" tools
